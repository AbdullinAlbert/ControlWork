# ControlWork
**Примечание.** Написать это приложение попросил меня мой брат, который работает в фирме, занимающаяся лесом: подготовка к массовой вырубке, посадка новых деревьев и т. п. Также у него есть вторая работа, на которой он делает металлические ленты за станком. Результаты его работы могут выражаться в часах, штуках, гектарах и т. д. Все нужно записать, иначе за работу могут начислить некорректную зарплату или же не заплатить вообще.
Естественно, у него есть desktop-приложение, которое создаёт ему нужные отчёты. Однако брату не хватало мобильности, которое может дать приложение на телефоне. А для меня это был шанс написать полезную программу, набраться опыта не только в Android-разработке, но и углубиться в суть разработки программного обеспечения в целом. Такова была идея.
Приложение ControlYourWork предназначено для того, чтобы контролировать результаты выполненной работы, которые могут выражаться в числах. Все данные сохраняются на локальную БД. Доступ к ней осуществляется через SQLiteOpenHelper, так как на момент начала написания программы ничего о Room и прочих DAO я не знал.
На данный момент оно не дописано, так как в процессе разработки были придуманы новые функциональные возможности, однако содержит базовый функционал, ради которого это приложение и создавалось – а именно, на основе имеющихся данных создавать PDF-отчёты о проделанной работе.
На первом экране представлена функция добавления общих данных: сотрудник, который выполнил работу, фирма для которой он выполнял эту работу, тип и место работы, дата, результат, тип результата и примечание. Почти на каждую 
При нажатии на соответствующую строку откроется новое окно – Activity, которое покажет список всех доступных записей из соответствующей таблицы БД: сотрудник, фирма, место работы, тип работы, тип результата:
![Image of Yaktocat](https://github.com/AbdullinAlbert/ControlWork/blob/develop/description/1.gif)
На экране добавления результатов реализована ещё одна особенность: при его открытии поля сотрудник, фирма и даты автоматически заполняются значениями по умолчанию. Для строк сотрудник и фирма берутся первые значения из соответствующих таблиц БД (позже я хотел добавить настройки выбора через Shared Preference), а для строки даты – текущая дата.  
**Примечание:** в «тех. задании» от брата не было пункта про список сотрудников. Этот пункт я хотел реализовать для себя, как технический вызов «на слабО». Хоть это и противоречит принципу YAGNI, но я же учусь писать программы, как законченный полезный продукт, поэтому никакой логики, вроде как, я не нарушал. 
Далее демонстрируется возможность добавления новых записей в одну из «первичных» таблиц. В данном случае все та же таблица с сотрудниками:
Вставить картинку 2
Реализация Selection Tracker с добавлением Contextual action bar (Выбор всех элементов, переименовать или удалить запись):
Вставить картинку 3 и 5
Реализация поиска по элементам RecyclerView. Снова необязательная функция и снова технический вызов самому себе. Для этого я даже основательно изучал регулярные выражения:
Вставить картинку 4
При нажатии на строку для даты открывается Material Design’s DatePicker:
Вставить картинку 6
Как уже писал выше, результат должен выражаться в числах, поэтому для строки результат установлен числовой ввод данных: 
Вставить картинку 7
Перед добавлением данных в таблицу результата программа проверяет существование выбранных записей в первичных таблицах. Если выбранные записи не существуют, программа не даст записать данные в таблицу с результатами и покажет в каких строках есть несоответствие:
Вставить картинку 8
Пример успешного добавления данных. Строки с результатом и примечанием очищаются:
Вставить картинку 9
Далее демонстрируется раздел редактирования/удаления данных из БД. Для того, чтобы пользователю было удобно искать какие-то конкретные записи, я постарался реализовать максимально гибкую систему составления запросов. Эту же систему я использовал и для выборки данных при составлении отчётов. Пример выбора записей в «первичных» таблицах:
 Вставить картинку 10
Естественно, возможность поиска среди записей я также оставил:
Вставить картинку 11
Возможность гибкой настройки поиска среди дат, результатов и примечаний я придумывал долго. И, в конце концов, реализовал идею через динамическое добавление View-элементов. Благо в LinearLayout это несложно:
Вставить картинку 12
Забавный факт, о котором я не знал: если динамически добавленному виджету, в моем случае – EditText, не присвоить id, то при смене конфигурации он не сохраняет введенный текст. Для меня это было большим удивлением и полным непониманием почему так происходит.
Пример редактирования критериев поиска:
Вставить картинку 13 и 14
Та же самая идея реализована и для результата:
Вставить картинку 15
Пример того, как программа сообщает о некорректном вводе данных для поиска:
Вставить картинку 16
Пример результата поиска по запросам для редактирования или удаления данных из таблицы результатов. Пытался сделать таблицу из RecyclerView:
Вставить картинку 17
Пример удаления и редактирования данных:
Вставить картинку 18 и 21
Перед составлением PDF-отчёта удобно предварительно посмотреть полученные данные в приложении. Вот так они выглядят на данный момент:
Вставить картинку 19
А вот так выглядит сам PDF-отчёт. Для этого я учился рисовать в Canvas. Можно сказать, что опыт создания custom-view имеется. Выборка данных, их обработка, создания PDF-документа, рисование в нем и сохранение его на внутренний диск осуществляются с помощью WorkManager:
21


